{
    "$schema": "http://json-schema.org/draft/2020-12/schema",
    "$id": "https://raw.githubusercontent.com/martin-lemay/pyWellSFM/main/jsonSchemas/AccumulationModelSchema.json",
    "title": "Input Accumulation Model Data",
    "description": "Defines the input data to create an accumulation model.\n\nThis schema matches the AccumulationModel class in src/pywellsfm/model/AccumulationModel.py:\n- accumulationModel.name: model name\n- accumulationModel.elements: dictionary mapping element name -> element accumulation model\n\nEach element accumulation model is either:\n- AccumulationModelElementGaussian\n- AccumulationModelElementEnvironmentOptimum",
    "type": "object",
    "properties": {
        "format": {
            "description": "Defines the file content for verification purposes.",
            "const": "pyWellSFM.AccumulationModelData"
        },
        "version": {
            "description": "Defines the file content version.",
            "const": "1.0"
        },
        "accumulationModel": {
            "description": "Accumulation model definition.",
            "type": "object",
            "properties": {
                "name": {
                    "description": "Name of the accumulation model.",
                    "type": "string",
                    "minLength": 1
                },
                "elements": {
                    "description": "Mapping from element name to its accumulation model.",
                    "type": "object",
                    "minProperties": 1,
                    "propertyNames": {
                        "type": "string",
                        "minLength": 1
                    },
                    "additionalProperties": {
                        "$ref": "#/$defs/ElementAccumulationModel"
                    }
                }
            },
            "required": ["name", "elements"],
            "additionalProperties": false
        }
    },
    "required": ["format", "version", "accumulationModel"],
    "additionalProperties": false,
    "$defs": {
        "ElementAccumulationModel": {
            "description": "Element accumulation model (AccumulationModelElementBase).",
            "type": "object",
            "properties": {
                "accumulationRate": {
                    "description": "Reference accumulation rate of the element (m/My).",
                    "type": "number"
                },
                "model": {
                    "description": "Element accumulation model definition. The model type is defined by the 'modelType' property.",
                    "type": "object",
                    "oneOf": [
                        { "$ref": "#/$defs/ElementGaussianModel" },
                        { "$ref": "#/$defs/ElementEnvironmentOptimumModel" }
                    ]
                }
            },
            "required": ["accumulationRate", "model"],
            "additionalProperties": false
        },
        "ElementGaussianModel": {
            "description": "Gaussian element accumulation model (AccumulationModelElementGaussian).",
            "type": "object",
            "properties": {
                "modelType": {
                    "description": "Discriminator for the element model type.",
                    "const": "Gaussian"
                },
                "stddevFactor": {
                    "description": "Standard deviation factor (stddev = stddevFactor * accumulationRate).",
                    "type": "number"
                }
            },
            "required": ["modelType", "stddevFactor"],
            "additionalProperties": false
        },
        "ElementEnvironmentOptimumModel": {
            "description": "Environment optimum element accumulation model (AccumulationModelElementEnvironmentOptimum).",
            "type": "object",
            "properties": {
                "modelType": {
                    "description": "Discriminator for the element model type.",
                    "const": "EnvironmentOptimum"
                },
                "accumulationCurves": {
                    "description": "List of accumulation reduction curves (AccumulationCurve). The environmental factor name is taken from each curve's xAxisName.",
                    "type": "array",
                    "minItems": 1,
                    "items": {
                        "oneOf": [
                            {
                                "description": "inline defintion of accumulation curve.",
                                "$ref": "https://raw.githubusercontent.com/martin-lemay/pyWellSFM/main/jsonSchemas/CurveSchema.json"
                            },
                            {
                                "type": "object",
                                "description": "Path to a curve.",
                                "properties": {
                                    "url": {
                                        "type": "string",
                                        "description": "Relative or absolute path to the curve file."
                                    }
                                },
                                "required": [
                                    "url"
                                ],
                                "additionalProperties": false
                            }
                        ],
                        "description": "Accumulation reduction curve for an environmental factor."
                    }
                }
            },
            "required": ["modelType", "accumulationCurves"],
            "additionalProperties": false
        }
    }
}